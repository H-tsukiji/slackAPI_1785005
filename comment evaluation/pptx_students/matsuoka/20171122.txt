時系列画像集合の類似度に基
づいた外観変化の検知手法の
検討


学籍番号：
1421166
氏名：松岡
未紗


指導教員：鷹野孝典



研究背景


.
観賞魚は環境適応能力が強まり，飼育経験の豊富でな
い人でもペットとして飼育可能
.
水温や水質によるストレスに弱い


.
飼育経験のない人にとって観賞魚の病気の早期発見は
困難
.
観賞魚が小さいために，病気の時に現れる外観や動きの
変化に気づきにくい




健康


白点病


熱帯魚の体に白い斑点


尾腐れ病


ヒレや尻尾が溶けるように
腐る



関連研究


.
画像
特徴を利用したイネ病気の判別・
分類［
2010
］
-
農業機械學
會誌
.
イネの病気に対して形状特徴・色特徴を判別条件とした．
6
種類の判
別分析法のうち，
SVM
の精度が
86
％で最も良好であった．


.
画像処理によるキュウリの葉の病気
診断［
2011
］
-
愛知教育大学
研究
報告
.
フラクタル次元がモザイク病識別に有効な特徴量であることを
示
した．


.
画像処理を用いた研磨面の評価［
2016
］
-
精密
工学会
.
研磨面の評価が写像性の類似度を用いて可能であることを示した．


.
ベルマークの画像識別［
2014
］
-
第
76
回全国大会講演論
文集
.
SURF
特徴が回転・スケールの変化・欠損に強いことを示した．





研究動機


.
観賞魚の外観の変化に着目して病気判定する場合，画
像認識技術を適用することが
可能


.
下記の課題点がある
.
観賞魚の個体の識別
.
個体
別の
模様
の
考慮
.
類似度を算出する際の比較データが１枚だけでは判
定材料が少なく正確な判定が困難





提案
方式


.
観賞魚
の個体
画像集合を
時系列で分類し，画
像類似度の差分を変化値として捉え，病気判
定する方式を提案
.
実験により実現可能性を検証する．
.
特定
の観賞魚の症状変化を追跡
.
模様
を考慮
し
た
外観
変化を検知





従来手法


.
初期画像集合と識別画像を比較
.
欠点：画像の向き・角度・光の加減に影響されやすい


1
枚目


・
・
・


2
枚目


Ｎ枚目


識別画像


初期画像
集合


初期画像集合と識別画像
の類似度



本研究の提案手法


.
初期画像集合と識別画像集合を比較
.
各識別画像の類似度の合計を識別画像集合の類似度とする
.
目的：画像の向き・角度・光の影響を減少




1
枚目


・
・
・


・
・
・


2
枚目


Ｎ枚目


1
枚目


2
枚目


Ｍ枚目


初期画像
集合


識別画像集合


初期画像集合と識別画像
1
枚目
の類似度


初期画像集合と識別画像
2
枚目
の類似度


…


初期画像集合と識別画像
M
枚
目の類似度


識別画像
1
枚目〜
M
枚目の類似度の合計
を識別画像集合の類似度とする



本研究のアプローチ


.
従来の手法では，初期
画像
集合と識別画像
(1
枚
)
を比較
.
本研究では，初期画像集合と
識別画像集合
を比較
.
算出した類似度を前日または初期類似度と比較


→ 
類似度の差分がしきい値を超えたら外観変化を検知


Ix(1)


Ix(2)


Ix(3)


類似
度
：
0.90


類似
度
：
0.87


類似
度
：
0.77


外観変化
を検知


差分：
0.03


差分：
0.10


Ix(0)



外観変化の検知機能
概要
図


初期画像
集合
I
x
(0
)


識別
する画像集合
I
x
(
t
)


類似度スコア
U
x
(0, 
t
)
を算
出


外観
変化検出


類似度スコアの差分
δ
x
(
t
p
, 
t
q
)
を算
出


δ
x
(
t
-
1, 
t
)
>
し
きい値
θ
2


True


Fals
e


外観変化なし


差分
δ
x
(0, 
t
)
>
し
きい
値
θ
3


Fals
e


True



システム概要図


分類
器


個体判定・
差分を検出


差がしき
い
値
を超えた場合，
外観変化の判
定


画像


(
複数枚
)


個体
ID
・


差分・撮影日を
タグ付け


時系列で分類


学習データ
に追加


前回
の画像集合・
初期画像集合と


識別画像集合の


類似度を比較


提案
方式



実験１（１）


.
目的
.
異なる模様の画像を学習データとして代用した場合の
外観変化検知


.
方法
.
似た柄の千代紙
2
種類を
1
組として，
4
組を
用意
.
何も加工を施さない場合を「健康
」
.
小さい白点を付与したものを「白点病
」
.
例：
柄
1
（健康
）
と
柄
2
（白点病
）
を学習データとした場合，
柄
1
（白
点）と柄
2
（健康
）
の分類確認




柄
1


柄
2


柄
7


柄
6


柄
5


柄
4


柄
3


柄
8


組み合
わせ
1


組み合わせ
2


組み合わせ
3


組み合わせ
4



実験１（２）


.
結果
.
4
組全てが，柄ごとに分類
.
異なる模様の画像を学習データとして代用した
場合，外観検知
は困難





実験２（１）


.
目的
.
提案手法による外観変化検知


.
方法
.
柄の異なる
4
種類の千代紙を観賞魚の個体
A, B, C, D
と見立てて
用意
.
時系列が進むごとに病気が進行と想定
.
何も加工を施さない場合を「健康
」
（
Day0
）
.
小さい白点を付与したものを「白点病
」
（
Day1
〜
Day5
）
.
一部切り取ったものを「尾腐れ病
」
（
Day1
〜
Day5
）




個体
A


（
Day1
）


個体
A


（
Day2
）


個体
A


（
Day3
）


個体
A


（
Day0
）


個体
B


（
Day0
）


個体
C


（
Day0
）


個体
D


（
Day0
）



実験２（２）


.
従来手法での実験結果
.
類似度の変動が激しい
.
時間の経過につれ病気が進行している様子を
捉え
ることは困難




00.050.10.150.20.250.30.35Day0Day1Day2Day3Day4Day51回目2回目3回目
00.050.10.150.2Day0Day1Day2Day3Day4Day51回目2回目3回目
個体
A
（尾腐れ病）


個体
A
（白点病）



実験２（３）


.
提案手法での実験結果
.
時間が経過するごとに類似度が減少
.
特に，
Day0
と
Day1
間
で類似度が
大きく
減少しているため，
Day1
で病気
症状の発見が可能




4050607080Day0Day1Day2Day3Day4Day5
画像集合類似スコア
時間区間
4050607080Day0Day1Day2Day3Day4Day5
画像集合類似スコア
時間区間
個体
A
（尾腐れ病）


個体
A
（白点病）



今後のスケジュール


.
データ収集
.
折り紙を用いた疑似実験画像
.
魚の
画像
.
データ拡張


.
実験
.
同一個体の判定
.
症状
変化
の判定
.
病気
の判定


.
論文執筆


枚数


エンゼルフィッシュ
（健康）


100


エンゼルフィッシュ
（白点病）


45


エンゼルフィッシュ
（尾腐れ病）


35




現在のデータ収集状況



